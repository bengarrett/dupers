# .goreleaser.yml
#
# To test this GoReleaser configuration:
# goreleaser check
# goreleaser release --clean --snapshot
project_name: dupers
before:
  hooks:
    - go mod tidy
builds:
  - id: Linux
    goos: ['linux']
    goarch: ['amd64', 'arm64']
  - id: macOS
    goos: ['darwin']
    goarch: ['amd64', 'arm64']
  - id: Windows
    goos: ['windows']
    goarch: ['amd64', '386']
universal_binaries:
  - id: macOS
    name_template: "{{ .ProjectName }}"
    replace: true

archives:
  - name_template: '{{ .ProjectName }}_{{ if eq .Os "darwin" }}macos{{ else }}{{ tolower .Os }}_{{ .Arch }}{{ end }}'
    files:
    - src: internal/logo.txt
      strip_parent: true
    format_overrides:
      - goos: windows
        format: zip
    rlcp: true

nfpms:
  - file_name_template: "{{ .ProjectName }}"
    vendor: Ben Garrett.
    homepage: https://github.com/bengarrett/dupers
    maintainer: Ben Garrett <code.by.ben@gmail.com>
    description: The blazing-fast file duplicate checker and filename search.
    license: LGPL 3.0
    section: utils
    formats:
      - apk
      - archlinux
      - deb
      - rpm

scoop:
  bucket:
    owner: bengarrett
    name: dupers
  homepage: "https://github.com/bengarrett/dupers/"
  description: "The blazing-fast file duplicate checker and filename search."
  license: LGPL 3.0
  # Setting this will prevent goreleaser to actually try to commit the updated
  # manifest leaving the responsibility of publishing it to the user.
  # If set to auto, the release will not be uploaded to the scoop bucket
  # in case there is an indicator for prerelease in the tag e.g. v1.0.0-rc1
  # Default is false.
  skip_upload: auto

changelog:
  sort: asc
  use: git
  filters:
    exclude:
    - '^test:'
    - '^chore'
    - 'merge conflict'
    - Merge pull request
    - Merge remote-tracking branch
    - Merge branch
    - go mod tidy